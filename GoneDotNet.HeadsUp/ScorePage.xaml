<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:headsUp="clr-namespace:GoneDotNet.HeadsUp"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:DataType="headsUp:ScoreViewModel"
             x:Class="GoneDotNet.HeadsUp.ScorePage"
             Shell.NavBarIsVisible="False">
    
    <Grid>
        <!-- Background Video -->
        <toolkit:MediaElement Source="{Binding VideoUrl}"
                              ShouldAutoPlay="True"
                              ShouldShowPlaybackControls="False"
                              Volume="0.3" 
                              ShouldLoopPlayback="True" 
                              HorizontalOptions="Fill"
                              VerticalOptions="Fill" />
        
        <!-- Semi-transparent overlay for better readability -->
        <BoxView BackgroundColor="Black" 
                 Opacity="0.2"
                 HorizontalOptions="Fill"
                 VerticalOptions="Fill" />
        
        <!-- Scrollable Content Overlay -->
        <ScrollView Padding="20" 
                    VerticalScrollBarVisibility="Never">
            <VerticalStackLayout Spacing="20">
                
                <!-- Header Section -->
                <Border BackgroundColor="{StaticResource GamePurple}"
                        StrokeThickness="0"
                        Padding="25,20"
                        Margin="0,40,0,0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="25"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,4" Radius="15" Opacity="0.4"/>
                    </Border.Shadow>
                    <VerticalStackLayout Spacing="8">
                        <Label Text="ðŸ† GAME RESULTS" 
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center">
                            <Label.Shadow>
                                <Shadow Brush="Black" Offset="1,1" Radius="3" Opacity="0.7"/>
                            </Label.Shadow>
                        </Label>
                        
                        <Label Text="{Binding Category}" 
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="{StaticResource GameYellow}"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>
                
                <!-- Score Summary -->
                <Border BackgroundColor="{StaticResource White}"
                        StrokeThickness="0"
                        Padding="20"
                        Opacity="0.95">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="20"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,3" Radius="10" Opacity="0.3"/>
                    </Border.Shadow>
                    <Grid ColumnDefinitions="*,*" 
                          RowDefinitions="Auto,Auto" 
                          RowSpacing="10"
                          ColumnSpacing="20">
                        
                        <Label Grid.Row="0" Grid.Column="0"
                               Text="ðŸ“Š Final Score"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="{StaticResource GamePurple}"
                               HorizontalOptions="Center"/>
                        
                        <Label Grid.Row="1" Grid.Column="0"
                               Text="{Binding Score}"
                               FontSize="32"
                               FontAttributes="Bold"
                               TextColor="{StaticResource GameOrange}"
                               HorizontalOptions="Center"/>
                        
                        <Label Grid.Row="0" Grid.Column="1"
                               Text="ðŸ“… Date Played"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="{StaticResource GamePurple}"
                               HorizontalOptions="Center"/>
                        
                        <Label Grid.Row="1" Grid.Column="1"
                               Text="{Binding CreatedAt, StringFormat='{0:MM/dd/yyyy}'}"
                               FontSize="16"
                               TextColor="{StaticResource Gray600}"
                               HorizontalOptions="Center"/>
                    </Grid>
                </Border>
                
                <!-- Main Menu Button -->
                <Border BackgroundColor="{StaticResource GamePink}"
                        StrokeThickness="0"
                        Padding="20,15"
                        Margin="0,20,0,0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="20"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,3" Radius="10" Opacity="0.4"/>
                    </Border.Shadow>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding BackCommand}" />
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="10" 
                                         HorizontalOptions="Center">
                        <Label Text="ðŸ " 
                               FontSize="24"
                               VerticalOptions="Center"/>
                        <Label Text="" 
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="White"
                               VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label"
                                             Binding="{Binding IsFromGame}"
                                             Value="True">
                                    <Setter Property="Text" Value="GO TO MAIN MENU" />
                                </DataTrigger>
                                <DataTrigger TargetType="Label"
                                             Binding="{Binding IsFromGame}"
                                             Value="False">
                                    <Setter Property="Text" Value="GO BACK TO SCORES" />
                                </DataTrigger>
                            </Label.Triggers>
                            <Label.Shadow>
                                <Shadow Brush="Black" Offset="1,1" Radius="2" Opacity="0.6"/>
                            </Label.Shadow>
                        </Label>
                    </HorizontalStackLayout>
                </Border>
                
                <!-- Answers Header -->
                <Border BackgroundColor="{StaticResource GameBlue}"
                        StrokeThickness="0"
                        Padding="20,15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="15"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,2" Radius="8" Opacity="0.3"/>
                    </Border.Shadow>
                    <Label Text="ðŸ“ ANSWER BREAKDOWN" 
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White"
                           HorizontalOptions="Center">
                        <Label.Shadow>
                            <Shadow Brush="Black" Offset="1,1" Radius="2" Opacity="0.6"/>
                        </Label.Shadow>
                    </Label>
                </Border>
                
                <!-- Answers List -->
                <VerticalStackLayout BindableLayout.ItemsSource="{Binding Answers}"
                            Spacing="12">
                    <BindableLayout.ItemTemplate>
                        <DataTemplate x:DataType="headsUp:AnswerResult">
                            <Border StrokeThickness="0"
                                    Padding="20,15"
                                    Opacity="0.95">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="12"/>
                                </Border.StrokeShape>
                                <Border.Shadow>
                                    <Shadow Brush="Black" Offset="0,2" Radius="6" Opacity="0.2"/>
                                </Border.Shadow>
                                <Border.Triggers>
                                    <DataTrigger TargetType="Border"
                                                 Binding="{Binding ResultType}"
                                                 Value="{x:Static headsUp:AnswerResultType.Success}">
                                        <Setter Property="BackgroundColor" Value="{StaticResource GameGreen}" />
                                    </DataTrigger>
                                    <DataTrigger TargetType="Border"
                                                 Binding="{Binding ResultType}"
                                                 Value="{x:Static headsUp:AnswerResultType.Pass}">
                                        <Setter Property="BackgroundColor" Value="{StaticResource GameOrange}" />
                                    </DataTrigger>
                                    <DataTrigger TargetType="Border"
                                                 Binding="{Binding ResultType}"
                                                 Value="{x:Static headsUp:AnswerResultType.Unanswered}">
                                        <Setter Property="BackgroundColor" Value="{StaticResource Gray500}" />
                                    </DataTrigger>
                                </Border.Triggers>
                                
                                <Grid ColumnDefinitions="Auto,*" 
                                      ColumnSpacing="15">
                                    
                                    <!-- Result Icon -->
                                    <Label Grid.Column="0"
                                           FontSize="24"
                                           VerticalOptions="Center">
                                        <Label.Triggers>
                                            <DataTrigger TargetType="Label"
                                                         Binding="{Binding ResultType}"
                                                         Value="{x:Static headsUp:AnswerResultType.Success}">
                                                <Setter Property="Text" Value="âœ…" />
                                            </DataTrigger>
                                            <DataTrigger TargetType="Label"
                                                         Binding="{Binding ResultType}"
                                                         Value="{x:Static headsUp:AnswerResultType.Pass}">
                                                <Setter Property="Text" Value="â­ï¸" />
                                            </DataTrigger>
                                            <DataTrigger TargetType="Label"
                                                         Binding="{Binding ResultType}"
                                                         Value="{x:Static headsUp:AnswerResultType.Unanswered}">
                                                <Setter Property="Text" Value="â°" />
                                            </DataTrigger>
                                        </Label.Triggers>
                                    </Label>
                                    
                                    <!-- Answer Text -->
                                    <Label Grid.Column="1"
                                           Text="{Binding Text}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="White"
                                           VerticalOptions="Center">
                                        <Label.Shadow>
                                            <Shadow Brush="Black" Offset="1,1" Radius="2" Opacity="0.5"/>
                                        </Label.Shadow>
                                    </Label>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </BindableLayout.ItemTemplate>
                </VerticalStackLayout>
                
                <!-- Bottom Spacing -->
                <BoxView HeightRequest="40" IsVisible="False" />
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>