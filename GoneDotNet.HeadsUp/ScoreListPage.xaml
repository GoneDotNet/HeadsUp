<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:headsUp="clr-namespace:GoneDotNet.HeadsUp"
             x:Class="GoneDotNet.HeadsUp.ScoreListPage"
             x:DataType="headsUp:ScoreListViewModel"
             Title="ðŸ† Scores">

    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="{StaticResource GradientStart}" Offset="0.0" />
            <GradientStop Color="{StaticResource GradientEnd}" Offset="1.0" />
        </LinearGradientBrush>
    </ContentPage.Background>

    <Grid RowDefinitions="Auto, *" Margin="20">
        
        <Border Grid.Row="0" 
                BackgroundColor="{StaticResource White}"
                StrokeThickness="0"
                Padding="20"
                Margin="0,10,0,20">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="25"/>
            </Border.StrokeShape>
            <Border.Shadow>
                <Shadow Brush="Black" Offset="0,2" Radius="8" Opacity="0.2"/>
            </Border.Shadow>
            <StackLayout>
                <Label Text="ðŸ† GAME HISTORY" 
                       FontAttributes="Bold"
                       FontSize="32"
                       TextColor="{StaticResource GamePurple}"
                       HorizontalOptions="Center"
                       Margin="0,0,0,5"/>
                
                <Label Text="Check out your amazing scores!" 
                       FontSize="18"
                       TextColor="{StaticResource GameBlue}"
                       HorizontalOptions="Center"
                       FontAttributes="Italic"/>
            </StackLayout>
        </Border>

        <CollectionView Grid.Row="1" 
                        ItemsSource="{Binding Games}">
            
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="15"/>
            </CollectionView.ItemsLayout>
            
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="headsUp:GameResultViewModel">
                    <Border BackgroundColor="{StaticResource White}"
                            StrokeThickness="0"
                            Padding="0"
                            HeightRequest="140">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="Black" Offset="0,3" Radius="10" Opacity="0.15"/>
                        </Border.Shadow>
                        
                        <Grid ColumnDefinitions="12, *">
                            <Border Grid.Column="0" 
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="20,0,0,20"/>
                                </Border.StrokeShape>
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="{StaticResource GameGreen}" Offset="0.0" />
                                        <GradientStop Color="{StaticResource GameTeal}" Offset="0.3" />
                                        <GradientStop Color="{StaticResource GameBlue}" Offset="0.6" />
                                        <GradientStop Color="{StaticResource GamePurple}" Offset="1.0" />
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            
                            <Grid Grid.Column="1" Padding="20">
                                <Grid.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="{StaticResource GameLightGreen}" Offset="0.0" />
                                        <GradientStop Color="{StaticResource GameLightBlue}" Offset="1.0" />
                                    </LinearGradientBrush>
                                </Grid.Background>
                                
                                <Grid.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding NavToScoreCommand}" />
                                </Grid.GestureRecognizers>
                                
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup x:Name="CommonStates">
                                        <VisualState x:Name="Normal">
                                            <VisualState.Setters>
                                                <Setter Property="Scale" Value="1" />
                                            </VisualState.Setters>
                                        </VisualState>
                                        <VisualState x:Name="Pressed">
                                            <VisualState.Setters>
                                                <Setter Property="Scale" Value="0.96" />
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                                
                                <StackLayout VerticalOptions="Center" Spacing="8">
                                    
                                    <!-- Date with shadow effect -->
                                    <Label Text="{Binding CreatedAt, StringFormat='{0:MMMM dd, yyyy}'}"
                                           FontAttributes="Bold"
                                           FontSize="24"
                                           TextColor="{StaticResource GamePurple}"
                                           HorizontalOptions="Start">
                                        <Label.Shadow>
                                            <Shadow Brush="{StaticResource GameLightPurple}" 
                                                    Offset="1,1" 
                                                    Radius="2" 
                                                    Opacity="0.3"/>
                                        </Label.Shadow>
                                    </Label>
                                    
                                    <Label Text="{Binding Category, StringFormat='ðŸ“‚ {0}'}" 
                                           FontSize="18"
                                           FontAttributes="Italic"
                                           TextColor="{StaticResource GameBlue}"
                                           HorizontalOptions="Start"/>
                                    
                                    <Grid ColumnDefinitions="*, Auto" VerticalOptions="End">
                                        <Label Grid.Column="0"
                                               Text="ðŸŽ¯ Your Performance:"
                                               FontSize="14"
                                               TextColor="{StaticResource Gray600}"
                                               VerticalOptions="Center"/>
                                        
                                        <Border Grid.Column="1"
                                                BackgroundColor="{StaticResource GameGreen}"
                                                StrokeThickness="0"
                                                Padding="15,8"
                                                HorizontalOptions="End">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="20"/>
                                            </Border.StrokeShape>
                                            <Label Text="{Binding CorrectAnswers, StringFormat='ðŸ† {0} Correct!'}" 
                                                   FontSize="14"
                                                   FontAttributes="Bold"
                                                   TextColor="{StaticResource White}"/>
                                        </Border>
                                    </Grid>
                                </StackLayout>
                            </Grid>
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>